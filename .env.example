# CAD Vector Database Configuration
# Copy this file to .env and update with your settings

# ===== Environment =====
ENV=development  # development, testing, production

# ===== Paths =====
WHUCAD_DATA_ROOT=/Users/he.tian/bs/WHUCAD-main/data/vec
INDEX_DIR=data/index_test
METADATA_DB_PATH=data/metadata.db
LOG_DIR=logs

# ===== Vector Configuration =====
FEATURE_DIM=32
USE_NORMALIZATION=true

# ===== Index Configuration =====
INDEX_TYPE=HNSW  # Flat, IVF, IVFFlat, HNSW, IVFPQ

# HNSW Parameters
HNSW_M=32
HNSW_EF_CONSTRUCTION=200
HNSW_EF_SEARCH=128

# IVF Parameters
IVF_NLIST=100
IVF_NPROBE=16

# ===== Retrieval Configuration =====
STAGE1_TOPN=100
STAGE2_TOPK=20

# Fusion
FUSION_METHOD=weighted  # weighted, rrf, borda
FUSION_ALPHA=0.6
FUSION_BETA=0.4
RRF_K=60

# ===== Server Configuration =====
API_HOST=127.0.0.1
API_PORT=8000
API_WORKERS=1
API_RELOAD=false

# ===== Security =====
# Enable API authentication
ENABLE_AUTH=false

# API Key (generate with: python -c "import secrets; print(secrets.token_urlsafe(32))")
# API_KEY=your-secret-api-key-here

# CORS allowed origins (comma-separated)
ALLOWED_ORIGINS=*

# Rate Limiting
RATE_LIMIT_ENABLED=true
RATE_LIMIT_REQUESTS=100
RATE_LIMIT_PERIOD=60

# ===== Database Configuration =====
DB_HOST=127.0.0.1
DB_PORT=2881
DB_NAME=cad_vector_db
DB_USER=root@test
# DB_PASSWORD=your-db-password-here

# Connection Pool
DB_POOL_SIZE=5
DB_POOL_RECYCLE=3600

# ===== Logging Configuration =====
LOG_LEVEL=INFO  # DEBUG, INFO, WARNING, ERROR, CRITICAL
LOG_FORMAT=json  # json or text
LOG_TO_FILE=true
LOG_TO_CONSOLE=true
LOG_MAX_BYTES=10485760  # 10MB
LOG_BACKUP_COUNT=5

# ===== Evaluation Configuration =====
EVAL_METRICS=precision,recall,map,latency
EVAL_K_VALUES=1,5,10,20

# ===== Production Notes =====
# For production deployment:
# 1. Set ENV=production
# 2. Enable authentication: ENABLE_AUTH=true
# 3. Set a strong API_KEY
# 4. Configure DB_PASSWORD
# 5. Restrict ALLOWED_ORIGINS
# 6. Enable rate limiting
# 7. Set LOG_LEVEL=WARNING or ERROR
# 8. Use multiple API_WORKERS for better performance
